
\documentclass{drl-common/llncs}

\usepackage{multicol}
\usepackage{mathptmx}
\usepackage{color}
\usepackage[cmex10]{amsmath}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{drl-common/proof}
\usepackage{drl-common/typesit}
\usepackage{drl-common/typescommon}
\usepackage[square,numbers,sort]{natbib}
%% \usepackage{arydshln}
\usepackage{graphics}
\usepackage{url}
\usepackage{relsize}
\usepackage{fancyvrb}
\usepackage{tikz}
\usetikzlibrary{decorations.pathmorphing}
\usepackage{tipa}

\usepackage{drl-common/code}
\DefineVerbatimEnvironment{code}{Verbatim}{fontsize=\small,fontfamily=tt}

%% small tightcode, with space around it
\newenvironment{stcode}
{\smallskip
\begin{small}
\begin{tightcode}}
{\end{tightcode}
\end{small}
\smallskip}

\newcommand{\inv}[1]{\ensuremath{{#1}^{-1}}}

\newcommand{\C}{\ensuremath{\mathcal{C}}}
\newcommand{\D}{\ensuremath{\mathcal{D}}}
\newcommand{\M}{\ensuremath{\mathcal{M}}}
\newcommand{\la}{\ensuremath{\dashv}}
\newcommand{\arrow}[3]{\ensuremath{#2 \longrightarrow_{#1} #3}}
\newcommand{\tc}[2]{\ensuremath{#1 \Rightarrow #2}}
\newcommand{\sh}{\text{\textesh}}
\newcommand{\Adj}{\textbf{Adj}}

\newcommand\compo[2]{\ensuremath{#1 \circ #2}}
\newcommand\compv[2]{\ensuremath{#1 \cdot #2}}
\newcommand\comph[2]{\ensuremath{#1 \mathbin{\circ_2} #2}}

\renewcommand\wftp[2]{\ensuremath{#1 \,\,\, \dsd{type}_{#2}}}
\newcommand\F[2]{\ensuremath{F_{#1} \,\, #2}}
\newcommand\U[2]{\ensuremath{U_{#1} \,\, #2}}
\newcommand\coprd[2]{\ensuremath{#1 + #2}}
\newcommand\seq[3]{\ensuremath{#1 \, [ #2 ] \, \vdash \, #3}}
\renewcommand\irl[1]{\dsd{#1}}

\newcommand\tr[2]{\ensuremath{{{#1}_{*}(#2)}}}
\newcommand\ident[1]{\ensuremath{\dsd{ident}_{#1}}}
\newcommand\cut[2]{\ensuremath{{\dsd{cut} \,\, #1 \,\, #2}}}
\newcommand\cuti{\ensuremath{\bullet}}

\newcommand\hyp[1]{\ensuremath{\dsd{hyp} \, {#1}}}
\newcommand\Inl[1]{\ensuremath{\dsd{Inl}(#1)}}
\newcommand\Inr[1]{\ensuremath{\dsd{Inr}(#1)}}
\newcommand\Case[2]{\ensuremath{\dsd{Case}(#1,#2)}}
\newcommand\UL[3]{\ensuremath{\dsd{UL}^{#1}_{#2}(#3)}}
\newcommand\FR[3]{\ensuremath{\dsd{FR}^{#1}_{#2}(#3)}}
\newcommand\FL[1]{\ensuremath{\dsd{FL}(#1)}}
\newcommand\UR[1]{\ensuremath{\dsd{UR}(#1)}}

\newcommand\ap[2]{\ensuremath{#1 \approx #2}}

\newcommand\Bx[2]{\ensuremath{\Box_{#1} \: {#2}}}
\newcommand\Crc[2]{\ensuremath{\bigcirc_{#1} \: {#2}}}

%% \newtheorem{\example}[theorem]{Example}

\title{Adjoint Logic with a 2-Category of Modes}

\author{Daniel R. Licata\inst{1} \and Michael Shulman\inst{2}
\thanks{
This material is based on research sponsored by The United States Air
Force Research Laboratory under agreement number FA9550-15-1-0053. The
U.S. Government is authorized to reproduce and distribute reprints for
Governmental purposes notwithstanding any copyright notation thereon.
The views and conclusions contained herein are those of the authors and
should not be interpreted as necessarily representing the official
policies or endorsements, either expressed or implied, of the United
States Air Force Research Laboratory, the U.S. Government, or Carnegie
Mellon University.
}}

\institute{Wesleyan University \and University of San Diego}

\begin{document}
\maketitle

\begin{abstract}
ABSTRACT
\end{abstract}

\section{Introduction}

An adjunction $F \la U$ between categories \C and \D\/ consists of a
pair of functors $F : \C \to \D$ and $U : \D \to \C$ such that maps
\arrow{\D}{F C}{D} correspond naturally to maps \arrow{\C}{C}{U D}.  A
prototypical adjunction, which provides a mnemonic for the notation, is
where $U$ takes the underlying set of some algebraic structure such as a
group, and $F$ is the free structure on a set---the adjunction property
says that a structure-preserving map from $F C$ to $D$ corresponds to a
a map of sets from $C$ to $U D$ (because the action on the structure is
determined by being a homomorphism).  Adjunctions are important to the
proof theories and $\lambda$-calculi of modal logics, because the
composite $FU$ is a comonad on \D, while $UF$ is a monad on $\C$.
\citet{bentonwadler96adjoint} describe an adjoint $\lambda$-calculus for
mixing linear logic and structural/cartesian logic, with functors $U$
from linear to cartesian and $F$ from cartesian to linear; the $! A$
modality of linear logic arises as the comonad $FU$, while the monad of
Moggi's metalanguage~\citep{moggi91monad} arises as $UF$.
\citet{reed09adjoint} describes a generalization of this idea to
situations involving more than one category: the logic is parametrized
by a preorder of \emph{modes}, where every mode $p$ determines a
category, and there is an adjunction $F \la U$ between categories $p$
and $q$ (with $F : q \to p$) exactly when $q \ge p$.  For example, the
intuitionistic modal logics of \citet{pfenningdavies} can be encoded as
follows: the necessitation modality $\Box$ is the comonad $FU$ for an
adjunction between ``truth'' and ``validity'' categories, the lax
modality $\bigcirc$ is the monad $UF$ of an adjunction between ``truth''
and ``lax truth'' categories, while the possibility modality $\diamond$
requires a more complicated encoding involving four adjunctions between
four categories.  While specific adjunctions such as $(- \times A) \la
(A \to -)$ arise in many logics, adjoint logic provides a formalism for
abstract/uninterpreted adjunctions.

In Reed's logic, modes are specified by a preorder, which allows at most
one adjunction between any two categories (more precisely, there can be
two isomorphic adjunctions if both $p \ge q$ and $q \ge p$).  However,
it is sometimes useful to consider multiple different adjunctions
between the same two categories.  A motivating example is Lawvere's
axiomatic cohesion~\citep{lawvereXXcohesion}, a general categorical
interface that describes \emph{cohesive spaces}, such as topological
spaces, or manifolds with differentiable or smooth structures.  The
interface consists of two categories \C and $\mathcal{S}$, and a
quadruple of adjoint functors $\Pi_0,\Gamma : \mathcal{C} \to
\mathcal{S}$ and $\Delta,\nabla : \mathcal{S} \to \mathcal{C}$ where
$\Pi_0 \la \Delta \la \Gamma \la \nabla$.  The idea is that
$\mathcal{S}$ is some category of ``sets'' that provides a notion of
``point'', and \C\/ is some category of cohesive spaces built out of
these sets, where points may be stuck together in some way (e.g. via
topology).  $\Gamma$ takes the underlying set of points a cohesive
space, forgetting the cohesive structure.  Its left adjoint $\Delta$
equips a set with \emph{discrete cohesion}, where no points are stuck
together; the adjunction says that a map \emph{from} a discrete space is
the same as a map of sets.  Its right adjoint $\nabla$ equips a set with
codiscrete cohesion, where all points are stuck together; the adjunction
says that a map \emph{into} a codiscrete space is the same as a map of
sets.  The left adjoint $\Pi_0 \la \Delta$, gives the set of connected
components---i.e. each element of $\Pi_0 C$ is an equivalence class of
points of $C$ that are stuck together.  $\Pi_0$ is important because it
translates some of the cohesive information about a space into a setting
where we no longer need to care about the cohesion.  These functors must
satisfy some additional laws, such as $\Delta$ and $\nabla$ being fully
faithful (maps between discrete or codiscrete cohesive spaces should be
the same as maps of sets).

A variation on axiomatic cohesion called \emph{cohesive homotopy type
  theory}~\citep{schreibershulman12cohesive,shulman15realcohesion} is
currently being explored in the setting of homotopy type theory and
univalent foundations~\citep{voevodsky06homotopy,uf13hott-book}.
Homotopy type theory uses Martin-L\"of's intensional type theory as a
logic of \emph{homotopy spaces}: the identity type provides an
$\infty$-groupoid structure on each type, and spaces such as the spheres
can be defined by their universal properties using higher inductive
types~\citep{lumsdaine+13hits,shulman11hitsblog,lumsdaine11hitsblog}.
Theorems from homotopy theory can be proved \emph{synthetically} in this
logic~\citep{ls13pi1s1,lb13pinsn,lf14emspace,lb15cubical,favonia14covering,cavallo14mayervietoris},
and these proofs can be interpreted in a variety of
models~\citep{shulman13inversediag,voevodsky+12simpluniv,coquand+13cubical}.
However, an important but subtle distinction is that there is no
\emph{topology} in synthetic homotopy theory: the ``homotopical circle''
is defined as a higher inductive type, essentially ``the free
$\infty$-groupoid on a point and a loop,'' which a priori has nothing to
do with the ``topological circle,'' $\{ (x,y) \in \mathbb{R}^2 \mid x^2
+ y^2 = 1\}$, where $\mathbb{R}^2$ has the usual topology.  This is both
a blessing and a curse: on the one hand, proofs are not encumbered by
topological details; but on the other, internally to homotopy type
theory, we cannot use synthetic theorems to prove facts about
topological spaces.

Cohesive homotopy type theory combines the synthetic homotopy theory of
homotopy type theory with the synthetic topology of axiomatic cohesion,
using an adjoint quadruple $\sh \la \Delta \la \Gamma \la \nabla$.  In
this higher categorical generalization, $\mathcal{S}$ is an
$(\infty,1)$-category of homotopy spaces (e.g. $\infty$-groupoids), and
$\C$ is an $(\infty,1)$-category of cohesive homotopy spaces, which are
additionally equipped with a topological or other cohesive structure at
each level.  The rules of type theory are now interpreted in \C, so that
each type has an $\infty$-groupoid structure (given by the identity
type) \emph{as well as} a separate cohesive structure on its objects,
morphisms, morphisms between morphisms, etc.  For example, types have
both morphisms, given by the identity type, and topological paths, given
by maps that are continuous in the sense of the cohesion.  As in the
1-categorical case, $\Gamma$ forgets the cohesive structure, yielding
the underlying homotopy space, while $\Delta$ and $\nabla$ equip a
homotopy space with the discrete and codiscrete cohesion.  But in the
$\infty$-categorical case, $\Delta$'s left adjoint $\sh A$ (pronounced
``shape of $A$'') generalizes from the connected components to the
\emph{fundamental homotopy space} functor, which makes a homotopy space
from the topological/cohesive paths, paths between paths, etc. of $A$.
This captures the process by which homotopy spaces arise from cohesive
spaces; for example, one can prove (using some additional axioms) that
the shape of the topological circle is the homotopy
circle~\citep{shulman15realcohesion}.  This allows synthetic
homotopy theory to be used in proofs about topological spaces, and opens
up possibilities for using synthetic homotopy theory as a tool in other
areas of mathematics and theoretical physics.

This paper begins an investigation into the structural proof theory of
cohesive homotopy type theory, as a special case of generalizing Reed's
adjoint logic to allow multiple adjunctions between the same categories.
As one might expect, the first step is to generalize the mode preorder
to a mode category, so that we can have multiple different morphisms
$\alpha, \beta : p\ge q$.  This allows the logic to talk about different
but unrelated adjunctions between two categories.  However, in order to
describe an adjoint triple such as $\Delta \la \Gamma \la \nabla$, we
need to know that the same functor $\Gamma$ is both a left and right
adjoint.  To describe such a situation, we generalize to a 2-category of
modes, where each mode $p$ determines a category, each morphism $\alpha
: p \ge q$ determines adjoint functors $F_\alpha : p \to q$ and
$U_\alpha : q \to p$ where $F_\alpha \la U_\alpha$, and each 2-cell $e :
\tc \alpha  \beta : q \ge p$ determines a morphism of adjunctions between 
$F_\alpha \la U_\alpha$ and $F_\beta \la U_\beta$.  For example, an
adjoint triple is described by the 2-category with
\begin{itemize}
\item objects $c$ and $s$
\item 1-cells $\Delta : s \ge c$ and $\nabla : c \ge s$
\item 2-cells $\tc {1_c} {\nabla \Delta}$ 
and $\tc {\Delta \nabla} {1_s}$ satisfying 
some equations
\end{itemize}
The 1-cells generate $F_\Delta \la U_\Delta$ and $F_\nabla \la
U_\nabla$, while the 2-cells are sufficient to prove that $U_\Delta$ is
naturally isomorphic to $F_\nabla$, so we can define $\Delta :=
F_\Delta$, $\nabla := U_\nabla$, and $\Gamma := U_\Delta \cong F_\nabla$
and have the desired triple adjunction.  Indeed, you may recognize this
2-category as the ``walking adjunction'' with $\Delta \la \nabla$---that
is, we give a triple adjunction by saying that the mode morphism generating
the left adjoint is itself left adjoint to the mode morphism generating the
right adjoint.

The main judgement of the logic is a ``mixed-category'' entailment
judgement \seq{A}{\alpha}{C} where $A$ has mode $q$ and $C$ has mode $p$
and $\alpha : q \ge p$.  Semantically, this judgement means a morphism
from $A$ to $C$ ``along'' the adjunction determined by $\alpha$---i.e. a
map $F_\alpha A \to C$ or $A \to U_\alpha C$.  However, taking the
mixed-mode judgement as primitive makes for a nicer sequent calculus:
$U$ and $F$ can be specified independently from each other, by left and
right rules, in such a way that identity and cut (composition) are
admissible.  While we do not consider focusing~\citep{andreoli92focus},
we conjecture that the connectives can be given the same focusing
behavior as in \citep{reed09adjoint}: $F$ is postive and $U$ is negative
(which, because limits are negative and colimits are positive, and
like-polarity connectives compose together well, matches what left and
right adjoints should preserve).

The resulting logic has a good definition-to-theorem ratio: from these
simple sequent calculus rules for $F$ and $U$, we can prove a variety of
general facts that are true for any mode 2-category ($F_\alpha$ and
$U_\alpha$ are functors; $F_\alpha U_\alpha$ is a comonad and $U_\alpha
F_\alpha$ is a monad; $F_\alpha$ preserves colimits and $U_\alpha$
preserves limits), as well as facts specific to a particular theory
(e.g. for the triple adjunction above, $\Gamma$ preserves both colimits
and limits, because it is an equivalent $U_\Delta$ and $F_\nabla$; the
comonad $\flat := \Delta\Gamma$ and monad $\sharp := \nabla\Gamma$ are
themselves adjoint).  Moreover, we can use different mode 2-categories
to add aditional structure; for example, moving from the walking
adjunction to the walking reflection (taking $\Delta \nabla = 1$)
additionally gives that $\Delta$ and $\nabla$ are full and faithful and
that $\flat$ and $\sharp$ are idempotent, which are some of the
additional conditions for axiomatic cohesion.

To study the basic ideas of 2-categorical adjoint logic, we make a few
simplifying restrictions for this paper. First, we consider only
single-hypothesis, single-conclusion sequents, defering an investigation
of products and exponentials to future work.  

Second, on the semantic side, we consider only 1-categorical semantics
of the derivations of the logic, rather than the $\infty$-groupoid
semantics that we are ultimately interested in.  More precisely, for any
2-category \M\/ of modes, we can interpret the logic using a
pseudofunctor $S : \M \to \Adj$, where $\Adj$ is the 2-category of
categories, adjunctions, and morphisms of adjunctions (conjugate natural
transformation).  By $S$, each mode determines a 1-category, and
derivations in the logic are interprered as morphisms in these
categories.  The action of $S$ on 1- and 2-cells is used to interpret
$F$ and $U$.  We show that the syntax forms such a pseudofunctor, and
conjecture that the syntax is initial in some category or 2-category of
pseudofunctors, but have not yet tried to make this precise.

Third, we consider only a logic of simple-types, rather than a dependent
type theory.  Consequently, we do not have an identity type available
for proving equalities of proof terms.  However, we need an equational
theory to make many of the statements above (e.g. ``$UF$ is a monad''
require proving some equational laws), and the definitional equalities
arising from admissibility of cut and identity are not sufficient.
Thus, in addition to the sequent calculus itself, we give an equality
judgement on sequent calculus derivations.  This judgement is
interpreted by actual equality of morphisms in the semantics above, but
we intend these rules to be propositional equalities in an eventual
adjoint type theory.

In Section~\ref{sec:rules}, we define the rules of the logic, prove
admissibility of identity and cut, and define an equational theory on
derivations.  In Section~\ref{sec:examples}, we give a variety of
examples of constructions in the logic, including those mentioned above,
as well as the rules for spatial type theory used
in~\citep{shulman15realcohesion}.  In Section~\ref{sec:semantics}, we
describe the 1-categorical semantics of the logic.  All of the syntactic
metatheory of the logic and the examples have been formalized in
Agda~\citep{norell07thesis}.

\section{Rules}
\label{sec:rules}

\subsection{Sequent Calculus}

The logic is parametrized by a strict 2-category of modes.  We write
$p,q$ for the 0-cells (modes), $\alpha,\beta,\gamma,\delta : p \ge q$
for the 1-cells, and $e : \tc \alpha \beta$ for the 2-cells.  We write
\compo{\beta}{\alpha} for 1-cell composition in function composition
order (i.e. if $\beta : r \ge q$ and $\alpha : q \ge p$ then
$\compo{\beta}{\alpha} : r \ge p$), \compv{e_1}{e_2} for vertical
composition of 2-cells in diagramatic order, and \comph{e_1}{e_2} for
horizontal composition of 2-cells in ``congruence of \compo{}{}'' order
(if $e_1 : \tc \alpha {\alpha'}$ and $e_2 : \tc \beta \beta'$ then
$\comph{e_1}{e_2} :
\tc{\compo{\alpha}{\beta}}{\compo{\alpha'}{\beta'}}$).  The equations
for 2-cells say that \compv{}{} is associative with unit $1_\alpha$ for
any $\alpha$, that \comph{}{} is associative with unit $1_1$, and that
the interchange law $\comph{(\compv{e_1}{e_2})}{(\compv{e_3}{e_4})} =
\compv{(\comph{e_1}{e_3})}{(\comph{e_2}{e_4})}$ holds.  We treat these
equations as definitional equalities in all judgements.

Each object $p$ of the mode category determines a category, and objects
of that category are types; the syntactic judgement \wftp{A}{p} will
mean that $A$ is an object of the category $p$.  A morphism $\alpha : q
\ge p$ in the mode category determines an adjunction between categories
$p$ and $q$, with $\F \alpha {} : q \to p$ and $\U \alpha {} : p \to q$;
syntactically, the action on objects is given by $\wftp{\F \alpha A}{p}$
when $\wftp{A}{q}$ and $\wftp{\U \alpha A}{q}$ when $\wftp{A}{p}$.  We
write $P$ for atomic propositions, each of which has a designated mode.
To add additional structure to a category or to all categories, we can
add rules for additional connectives; for example, a rule
\wftp{\coprd{A}{B}}{p} if \wftp{A}{p} and \wftp{B}{p} (parametric in
$p$) says that any category $p$ has a coproduct type constructor.

The sequent calculus judgement has the form \seq A \alpha C where
\wftp{A}{q} and \wftp{C}{p} and $\alpha : q \ge p$.  That is, the
judgement represents a map from an object of some category $q$ to an
object of another category $p$ along some adjunction $\F \alpha {} \la
\U \alpha {}$.  Semantically, this mixed-category map can be interpreted
equivalently as an arrow \arrow{p}{\F \alpha A}{C} or \arrow{q}{A}{\U
  \alpha C}.  In the rules, we write $A_p$ indicate an elided premise
\wftp{A}{p}.

The rules for atomic propositions and for $U$ and $F$ are as follows:
\[
\begin{array}{c}
\infer[\irl{hyp}]
      {\seq P \alpha P}
      {\tc 1 \alpha}
\\ \\
\infer[\irl{FL}]
      {\seq {\F {\alpha : r \ge q} A_r} {\beta : q \ge p}{C_p}}
      {\seq {A_r} {\compo{\alpha}{\beta}} {C_p}
      }
\quad
\infer[\irl{FR}]
      {\seq {C_r} {\beta : r \ge p} {\F {\alpha : q \ge p} A_q}}
      { \gamma : r \ge q & \tc{\compo{\gamma}{\alpha}}{\beta} &
        \seq {C_r} \gamma {A_q}}
\\ \\
\infer[\irl{UL}]
      {\seq {\U {\alpha : r \ge q} A_q} {\beta : r \ge p} {C_p}}
      { \gamma : q \ge p &
        \tc{\compo{\alpha}{\gamma}} {\beta} &
        \seq{A_q}{\gamma}{C_p}}
\quad
\infer[\irl{UR}]
      {\seq {C_r} {\beta : r \ge q} {\U {\alpha : q \ge p} A_p}}
      {\seq {C_r} {\compo{\beta}{\alpha}} {A_p}}
\end{array}
\]

The rules for other connectives do not change $\alpha$; for example, we
can add coproducts to every category with the following rules (where
$\alpha : q \ge p$):
\[
\infer[\irl{Inl}]
      {\seq {C_q} {\alpha} {\coprd{A_p}{B_p}}}
      {\seq {C_q} {\alpha} {A_p}}
\quad
\infer[\irl{Inr}]
      {\seq {C_q} {\alpha} {\coprd{A_p}{B_p}}}
      {\seq {C_q} {\alpha} {B_p}}
\quad
\infer[\irl{Case}]
      {\seq {\coprd{A_q}{B_q}} {\alpha} {C_p}}
      {\seq {A_q} {\alpha} {C_p} & 
       \seq {B_q} {\alpha} {C_p} 
      }
\]
Alternatively, we could restrict these rules to where $p$ is some
specific set of modes to have coproducts only in those categories.

To understand the rules for $F$ and $U$, it is helpful to begin with
\irl{FL} and \irl{UR}.  In the special case where $\beta$ is 1, these
rules pass from \seq{\F {\alpha}{A}}{1}{C} and \seq{A}{1}{\U{\alpha}{C}}
to \seq{A}{\alpha}{C}, which makes sense because the judgement
\seq{A}{\alpha}{C} is intended to mean either/both of these.  When
$\beta$ is not 1, these rules also express some functoriality of
$\F{\compo{\alpha}{\beta}}{}$ and $\U{\compo{\beta}{\alpha}}$ (see
below).  While we do not formally give a focused sequent calculus, we
conjecture that these two rules are \emph{invertible}: whenever you have
\F{\alpha}{A} on the left or \U{\alpha}{A} on the right, you can
immediately apply the rule, no matter what is on the other side of the
sequent.  

On the other hand, \irl{UL} and \irl{FR} are not rules that you can
apply at any time, because they involve some constraints that may not be
satisfied.  Consider \irl{FR}: we have $\alpha : q \ge p$ and $\beta : r
\ge p$ and want to reduce proving \F{\alpha}{A} from $C$ to proving $A$
from $C$.  However, there is not necessarily any relationship between
$C$'s mode $r$ and $A$'s mode $q$, because all we know is that both of
these are bigger than $p$.  Thus, to form a premise sequent, we need to
choose a $\gamma : r \ge q$.  To make adjunctions generated by different
morphisms be different, it is important that we choose not just any
$\gamma$, but one where the triangle that it forms with $\alpha$ and
$\beta$ is filled by a 2-cell, which is the second premise of the rule.
The case for \irl{UR} is dual.  We now give some examples to illustrate
the rules.  

\paragraph{Functoriality} For example, the functorial action of $F$ on terms is
  derived as follows: given $\alpha : q \ge p$ and $D :
  \seq{A}{1_q}{B}$, we have
\[
\infer[\irl{FL}]
      {\seq{\F \alpha A}{1_p}{\F \alpha B}}
      {\infer[\irl{FR}]
        {\seq{A}{\compo{\alpha} {1_p}}{\F \alpha B}}
        {\infer{1_q : q \ge q}{} & \infer{1 : \tc{\compo{1_q} \alpha}{\compo {\alpha} {1_p}}}{} & D : \seq{A}{1_q}{B}}}
\]
Because \M\/ is a strict 2-category, the identity 2-cell has type 
\tc{\compo{1_q} \alpha}{\compo {\alpha} {1_p}}.  We will often apply
these equations silently.  

\paragraph{Comonad} Define $\Bx \alpha A := \F \alpha (\U \alpha A)$
where $\alpha : q \ge p$.
The comonad operations are defined as follows:

\[
\begin{small}
\begin{array}{c}
\infer[\irl{FL}]{\seq{\Bx{\alpha}{P}}{1}{P}}
      {\infer[\irl{UL}]
        {\seq{\U \alpha P}{\alpha}{A}}
        {\infer{1 : p \ge p}{} & \infer{1 : \tc{\compo{\alpha}{1_p}}{\alpha}}{} &
          \infer[\irl{hyp}]{\seq{P}{1}{P}}{\infer{1 : \tc{1}{1}}{}}  }}
\\
\infer[\irl{FL}]{\seq{\Bx{\alpha}{P}}{1}{\Bx{\alpha}{\Bx{\alpha}{P}}}}
      {\infer[\irl{FR}]{\seq{\U{\alpha}{P}}{\alpha}{\Bx{\alpha}{\Bx{\alpha}{P}}}}
        {\infer{1 : q \ge q}{} & 
          \infer{1 : \tc {\alpha} {\alpha}}{} & 
          \infer[\irl{UR}]
                {\seq{\U{\alpha}{P}}{1}{\U {\alpha} {\Bx \alpha P}}}
                {\infer[\irl{FR}]{\seq{\U{\alpha}{P}}{\alpha}{\Bx \alpha P}}
                  {\infer{1 : q \ge q}{} &
                   \infer{1 : \tc \alpha \alpha}{} &
                   \infer[\irl{UR}]{\seq{\U{\alpha}{P}}{1}{\U \alpha P}}
                         {\infer[\irl{UL}]{\seq{\U \alpha P}{\alpha}{P}}
                           {\infer{1 : p \ge p}{} & \infer{1 : \tc {\alpha} {\alpha}}{} &
                             \infer[\irl{hyp}]{\seq{P}{1}{P}}{\infer{\tc{1}{1}}{}}
                         }}}}}}
\end{array}
\end{small}
\]
%
The same derivations work for an arbitrary type $A$ if we replace the
final premise by the admissible identity princinple \seq{A}{1}{A},
defined below.  Using a proof term notation, we write the above
derivations as \FL{\UL{1}{1}{\hyp{1}}} and
\FL{\FR{1}{1}{\UR{\FR{1}{1}{\UR{\UL{1}{1}{\hyp{1}}}}}}}.

An advantage of using a cut-free sequent calculus is that we can observe
some non-provabilities: for example, there is not in general a map
\seq{P}{1_p}{\Bx{\alpha}{P}}. By inversion, a derivation must begin with
\irl{FR}, but to apply this rule, we need a $\gamma : p \ge q$ and a
2-cell $\tc{\compo{\gamma}{\alpha}}{1}$, which may not exist.

\paragraph{$F$ preserves coproducts} As another example, we show a map
from \F \alpha {(\coprd{P}{Q})} to \coprd{\F \alpha P}{\F \alpha Q},
which is part of an isomorphism:
\[
\infer[\irl{FL}]{\seq{\F \alpha {(\coprd{P}{Q})}}{1}{\coprd{\F \alpha P}{\F \alpha Q}}}
      {\infer[\irl{Case}]
        {\seq{\coprd{P}{Q}}{\alpha}{\coprd{\F \alpha P}{\F \alpha Q}}}
        {\infer[\irl{Inl}]
          {\seq{P}{\alpha}{\coprd{\F \alpha P}{\F \alpha Q}}}
          {\infer[\irl{FR}]
                 {\seq{P}{\alpha}{\F \alpha P}}
                 {\infer{1 : q \ge q}{} & \infer{1 : \tc{\alpha}{\alpha}}{} & \infer[\irl{\hyp 1}]{\seq{P}{1}{P}}{}}}
          &
         \infer[\irl{Inr}]
          {\seq{Q}{\alpha}{\coprd{\F \alpha P}{\F \alpha Q}}}
          {\infer[\irl{FR}]
                 {\seq{Q}{\alpha}{\F \alpha Q}}
                 {\infer{1 : q \ge q}{} & \infer{1 : \tc{\alpha}{\alpha}}{} & \infer[\irl{\hyp 1}]{\seq{Q}{1}{Q}}{}}}
         }}
\]
The key idea is that we can apply the left rule for $F$ first, and then
case-analyze the $\coprd{P}{Q}$, before choosing between \irl{Inl} and
\irl{Inr} on the right; this is the direction of map doesn't exist for
\U{\alpha}{(\coprd{P}{Q})} because the left rule for $U$ cannot be
applied until after applying \irl{UR}.  

\paragraph{$F/U$ on identity and composition}

For identity and composition of 1-cells, an obvious question is the
relationship between $\F 1 A$ and $\U 1 A$ and $A$, between $\F
{\compo{\beta}{\alpha}} A$ and $\F \alpha {(\F \beta A)}$, and between $\U
{\compo{\beta}{\alpha}} A$ and $\U \beta {(\U \alpha A)}$.
We do not have definitional equalities of types, but the types in each
group are isomorphic (in a sense that will be made precise below).  
For example, the maps for $F$ are as follows:

\[
\infer[\irl{FL}]
      {\seq{\F 1 P}{1}{P}}
      {\infer[\hyp 1]{\seq{P}{\compo 1 1}{P}}{}}
\qquad
\infer[\irl{FR}]
      {\seq{P}{1}{\F 1 P}}
      { \infer{1 : p \ge p}{} &
        \infer{1 : \tc{\compo{1}{1}}{1}}{} &
        \infer[\hyp 1]{\seq{P}{1}{P}}{}}
\]
\[
\infer[\irl{FL}]
      {\seq{\F {\compo{\beta}{\alpha}} P}{1}{\F \alpha {(\F \beta P)}}}
      {\infer[\irl{FR}]
             {\seq{P}{\compo{(\compo{\beta}{\alpha})}{1}}{\F \alpha {(\F \beta P)}}}
             {{\beta : r \ge p} & 
              \infer{1 : \tc{\compo{(\compo{\beta}{\alpha})}{1}}{\compo \beta \alpha}}{} & 
              \infer{\seq{P}{\beta}{\F \beta P}}
                    {\infer{1 : r \ge r}{} &
                      \infer{1 : \tc{\compo{1}{\alpha}}{\alpha}}{} &
                      \infer[\irl{\hyp 1}]{\seq{P}{1}{P}}{}
                    }
             }}
\]
\[
\infer[\irl{FL}]
      {\seq{\F \alpha {(\F \beta P)}}{1}{\F {\compo{\beta}{\alpha}} P}}
      {\infer[\irl{FL}]
             {\seq{\F \beta P}{\compo{\alpha}{1}}{\F {\compo{\beta}{\alpha}} P}}
             {\infer[\irl{FR}]
               {\seq{P}{\compo{\beta}{(\compo{\alpha}{1})}}{\F {\compo{\beta}{\alpha}} P}}
               {\infer{1 : r \ge r}{} & 
                 \infer{1 : \tc {\compo{1}{(\compo{\beta}{\alpha})}} {\compo{\beta}{(\compo{\alpha}{1})}}}{} &
                 \infer[\irl{\hyp 1}]{\seq{P}{1}{P}}{}
               }}}
\]
These derivations use the unit laws for \compo{1}{\alpha} and \compo{\alpha}{1}.

\paragraph{$F/U$ on 2-cells}
For every 2-cell $e : \tc \alpha \beta$, we have derivations of \seq{\F
  \beta P}{1}{\F \alpha P} and \seq{\U \alpha P}{1}{\U \beta P}.
\[
\infer[\irl{FL}]
      {\seq{\F \beta P}{1}{\F \alpha P}}
      {\infer[\irl{FR}]{\seq{P}{\beta}{\F \alpha P}}
                       {\infer{1 : q \ge q}{} & {e : \tc{\compo 1 \alpha}{\beta}} & \infer[\hyp{1}]{\seq{P}{1}{P}}{} }{}}
\qquad
\infer[\irl{UR}]
      {\seq{\U \alpha P}{1}{\U \beta P}}
      {\infer[\irl{UL}]
             {\seq{\U \alpha P}{\beta}{P}}
             { \infer{1 : p \ge p}{} & e : \tc{\compo{\alpha}{1}}{\beta} & \infer[\hyp 1]{\seq{P}{1}{P}}{}}}
\]
The other directions are not provable in general.  These derivations
determine an adjunction morphism between $F_\beta \la U_\beta$ and
$F_\alpha \la U_\alpha$.


\subsection{Admissible Rules}

\paragraph{Adjunction morphisms}

The following rule provides the action of a 2-cell $e : \tc \alpha
\beta$ on a derivation $D : \seq{A}{\alpha}{B}$.  Semantically, $D$ is
interpreted as a map \arrow{}{\F \alpha A}{B} (say), so to get a map
\arrow{}{\F \beta A}{B} we can precompose with the $F$ part of the
morphism of adjunctions determined by $e$.

\[
\infer[\irl{\tr{-}{-}}]
      {\seq A {\beta} B}
      {\tc \alpha \beta &
       \seq A {\alpha} {C}}
\]

Because we will care about the equational properties of this operation,
we give its definition as a transformation on derivations.  We will
elide the cases for coproducts, which are included in the companion Agda
code.  

\[
\begin{array}{rcl}
  \tr {e}{\hyp e'} & := & \hyp {(\compv{e'}{e})}\\
  \tr {e}{\FR \gamma {e'} D} & := & \FR \gamma {\compv{e'}{e}} D \\
  \tr {e}{\FL D} & := &\FL {\tr{(\comph{1}{e})} D}\\
  \tr {e}{\UL \gamma {e'} D} & := & \UL \gamma {\compv{e'}{e}} D\\
  \tr {e}{\UR D} & := & \UR {\tr {(\comph{e}{1})} D} \\
\end{array}
\]
%
The hypothesis rule and \irl{FR} and \irl{UL} build in some movement
along a 2-cell, so in those cases we compose the $e$ with the 2-cells
that are already present.  For \irl{FL} and \irl{UR} (and for the rules
for coproducts), the operation commutes with the rule.

\paragraph{Identity}

The identity rule is admissible:
\[
\infer[\irl{ident}]
      {\seq {A_p} {1} {A_p}}
      {}
\]
The general strategy is ``apply the invertible rule and then the focus
rule and then the inductive hypothesis.'' For example, for $\F \alpha
A$, the following reduces the problem to identity on $A$:
\[
\infer[\irl{FL}]
      {\seq{\F {\alpha : q \ge p} A}{1}{\F \alpha A}}
      {\infer[\irl{FR}]
             {\seq{A}{\alpha}{\F \alpha A}}
             {1_q : q \ge q & 1 : \tc{\compo{1}{\alpha}}{\alpha} &
               \seq{A}{1}{A}}}
\]
As a function from types to derivations, we have
\[
\begin{array}{rcl}
  \ident{P} & := & \hyp 1\\
  \ident{\U \alpha A} & := & \UR {\UL 1 1 {\ident A}}\\
  \ident{\F \alpha A} & := & \FL {\FR 1 1 {\ident A}}\\
\end{array}
\]

\paragraph{Cut}

The following cut rule is admissible:
\[
\infer[\irl{cut}]
      {\seq {A_r} {\compo{\beta}{\alpha}} {C_p}}
      {\seq {A_r} {\beta} {B_q} &
       \seq {B_r} {\alpha} {C_p}}
\]

For example, consider the principal cut for $F$:
\[
\infer[\irl{cut}]
      {\seq {A} {\compo{\beta}{\alpha}} {C}}
      {\infer[\irl{FR}]
             {\seq {A} {\beta} {\F {\alpha_1} B}}
             {e : \tc{\compo{\gamma}{\alpha_1}}{\beta} & 
              D : \seq {A} {\gamma} {B}} &
       \infer[\irl{FL}]
             {\seq {\F {\alpha_1} B} {\alpha} {C}}
             {E : {\seq{B}{\compo{\alpha_1}{\alpha}}{C}}}}
\]
In this case the cut reduces to
\[
\infer[\irl{\tr{-}{-}}]
      {\seq{A}{\compo{\beta}{\alpha}}{C}}
      {\comph{e}{1} : \tc {\compo{(\compo{\gamma}{\alpha_1})}{\alpha}} {\compo{\beta}{\alpha}} &
        \infer[\irl{cut}]
              {\seq{A}{\compo{\compo{\gamma}{\alpha_1}}{\alpha}}{C}}
              {D : \seq{A}{\gamma}{B} &
                E : \seq{B}{\compo{\alpha_1}{\alpha}}{C}}}
\]

As a transformation on derivations, we have
\[
\begin{array}{rcll}
  \cut {(\hyp e)} {(\hyp {e'})} & := & \hyp {\comph{e}{e'}}\\
  \cut {(\FR \gamma e D)} {(\FL E)} & := & \tr {\comph{e}{1}} {\cut D E}\\
  \cut {(\UR D)} {(\UL \gamma e E)} & := & \tr {\comph{1}{e}} {\cut D E}\\
  \cut D {(\FR \gamma e E)} & := & \FR {\compo{\beta}{\gamma}} {\comph{1}{e}} {\cut D E}\\
  \cut D {(\UR E)} & := & \UR {\cut D E} \\
  \cut {(\FL D)} E & := & \FL {\cut D E} & \text{if $E$ is not a right rule} \\
  \cut {(\UL \gamma e D)} E & := & \UL {\compo{\gamma}{\alpha}} {\comph{e}{1}} {\cut D E} & \text{if $E$ is not a right rule}
\end{array}
\]

The first case is for atomic propositions.  The next two cases are the
principal cuts, when a right rule meets a left rule; these correspond to
$\beta$-reduction in natural deduction.  The next two cases are
right-commutative cuts, which push any $D$ inside a right rule for $E$.
The final two cases are left commutative cuts, which push any $E$ inside
a left rule for $D$.  The left-commutative and right-commutative cuts
overlap when $D$ is a left rule and $E$ is a right rule; we resolve this
arbitrarily by saying that right-commutative cuts take precedence.
Using the equational theory below, we will be able to prove the
unrestricted left-commutative rules.

\paragraph{Adjunction} As an example, we give one of the maps from the
bijection-on-hom-sets adjunction for $F$ and $U$: given $\alpha : q \ge
p$ we can transform $D : \seq { \F \alpha A}{1}{B}$ into
{\seq{A}{1}{\U \alpha B}}:
\[
\infer[\irl{UR}]{\seq{A}{1}{\U \alpha B}}
      {\infer[\irl{cut}]
             {\seq{A}{\alpha}{B}}
             {\infer[\irl{FR}]
                    {\seq{A}{\alpha}{\F \alpha A}}
                    {\infer{1 : q \ge q}{} & \infer{1 : \tc{\alpha}{\alpha}}{} & \infer[\irl{ident}]{\seq{A}{1}{A}}{} } & 
               D : \seq { \F \alpha A}{1}{B} }}
\]


\subsection{Equations}

The above definitions of \tr{e}{D} and \ident{A} and \cut{D}{E} give a
notion of definitional equality of proofs, but to prove the desired
equations in the examples below, we will need some additional
``propositional'' equations.  We define a judgement \ap{D}{D'} on two
derivations $D,D' : \seq{A}{\alpha}{C}$ to be the least congruence
closed under the following rules.  First, we have uniqueness/$\eta$
rules, which say that any map from a positive/into a negative is equal
to a derivation that begins with an application of the left/right rule,
respectively, and then cuts the original derivation with the right/left
rule, respectively.  For $F$ and $U$ we have:

\[
\begin{array}{l}
\infer[\irl{F\eta}]
      {\ap{D}{\FL {\cut{(\FR 1 1 {\ident{A}})}{D}} }}
      {D : \seq{\F \alpha A}{\beta}{C}}
\quad
\infer[\irl{U\eta}]
      {\ap{D}{\UR {\cut{D}{(\UL 1 1 {\ident{A}})}}}}
      {D : \seq{C}{\beta}{\U \alpha A}}
\end{array}
\]

Second, we have rules arising from the 2-cell structure.  For example,
suppose we construct a derivation by $\FR{\gamma}{e}{D}$ for some
$\gamma : r \ge q$ and $e : \tc {\compo{\gamma}{\alpha}}{\beta}$, but
there is another morphism $\gamma' : r \ge q$ such that there is a
2-cell between $\gamma$ and $\gamma'$.  The following says that we can
equally well pick $\gamma'$ and suitably transformed $e$ and $D$, 
using composition and \tr{e_2}{-} to make the types match up.  
\[
\infer{\ap{\FR{\gamma}{e}{\tr{e_2}{D'}}}{\FR{\gamma'}{(\compv{(\comph{e_2}{1})}{e})}{D'}}}
      {e : \tc{\compo{\gamma}{\alpha}}{\beta} & 
       D : \seq{C}{\gamma'}{A} &
       e_2 : \tc{\gamma'}{\gamma} & }
\quad
\infer{\ap{\UL{\gamma}{e}{\tr{e_2}{D'}}}{\UL{\gamma'}{(\compv{(\comph{1}{e_2})}{e})}{D'}}}
      {e : \tc{\compo{\gamma}{\alpha}}{\beta} & 
       D : \seq{C}{\gamma'}{A} &
       e_2 : \tc{\gamma'}{\gamma} & }
\]
Semantically, these rules will be justified by some of the pseudofunctor
laws.

The final rules say that left rules of negatives and right rules of
positives commute. These are needed to prove the left-commutative cut
equations in the case where $E$ is a right rule, because we chose to
give right-commutative cuts precedence defintionally (the full
left-commutative equations seem necessary for proving some of the
theorems we want to prove below.)  For $U$ and $F$, we have
\[
\infer{\ap{\UL {}{e_2} {\FR {} {e_1} {D}}}{\FR {} {e_4} {\UL {} {e_3} {D}}}}
      {\compv{(\comph{1}{e_1})}{e_2} \equiv {\compv{(\comph{e_3}{1})}{e_4}}}
\]
We elide the details of the typing of the 2-cells $e_i$, which will not
be needed below; they are the most general thing that makes both sides
of the conclusion type check.

\paragraph{Admissible rules}

The following equality rules are admissible.  The proofs have a lot of
cases (about 800 lines of Agda total) but are not difficult, except for
somewhat subtle staging.  The rules in each of the following groups
(except the first) are proved by mutual induction, and use the preceding
groups:

\begin{enumerate}
\item 
For each $D$, \tr{e}{D} is functorial on the 2-cell identity and
vertical composition: 

\[
\infer{\tr{1}{D} \equiv D}{}
\qquad
\infer{\tr{(\compv{e_1}{e_2})}{D} \equiv \tr{e_2}{\tr{e_1}{D}}}
      {}
\]

It is important for the remaining proofs that these are definitional
equalities, not $\ap{}{}$, so that we can use them ``in context'' before
we know that cut is well-defined on $\ap{}{}$.

\item 
\tr{e}{-} is well-defined on \ap{}{}:

\[
\infer{\ap{\tr{e}{D}}{\tr{e}{D'}}}
      {\ap{D}{D'}}
\]

and \tr{e}{-} commutes with cut:

\[
\infer{\ap{\tr{(\comph{e}{e'})}{\cut{D}{D'}}}{\cut{(\tr{e}{D})}{(\tr{e'}{D'})}}}
      {e : \tc{\alpha}{\alpha'} &
       e' : \tc{\beta}{\beta'} &
       D : \seq{A}{\alpha}{B} &
       D' : \seq{B}{\beta}{C}}
\]

\item Cut is associative:

\[
\infer{\ap{\cut{D_1}{(\cut{D_2}{D_3})}}{\cut{(\cut{D_1}{D_2})}{D_3}}}
      {}
\]

\item Cut is well-defined on $\ap{}{}$, identities are units for cut,
  and the left-commutative cut rules hold always (they are true
  definitionally only when $E$ is not a right rule).

\[
\infer{\ap{\cut{D}{\ident{}}}{D}}
      {}
\quad
\infer{\ap{\cut{\ident{}}{D}}{D}}
      {}
\quad
\infer{\ap{\cut{D}{E}}{\cut{D'}{E}}}
      {\ap{D}{D'}}
\quad
\infer{\ap{\cut{D}{E}}{\cut{D}{E'}}}
      {\ap{E}{E'}}
\]

\[
\infer{\ap{\cut {(\FL D)} E} {\FL {\cut D E}}}{}
\quad 
\infer{\ap{\cut {(\UL \gamma e D)} E} {\UL {\compo{\gamma}{\alpha}} {\comph{e}{1}} {\cut D E}}}{}
\]

\end{enumerate}

\section{Properties of the Syntactic Category}
\label{sec:examples}

\newcommand\iso{\cong}
\newcommand\ltor[2]{\ensuremath{#1^{\vartriangleright_{#2}}}}
\newcommand\rtol[2]{\ensuremath{#1^{\vartriangleleft_{#2}}}}

In this section, we investigate some constructions on $F$ and $U$ that
hold for any mode specfication $\M$.  First, we show that the syntax
forms a pseudofunctor $\M \to \Adj$, where $\Adj$ is the 2-category of
categories, adjunctions, and conjugate natural transformations.  Since
the objects of \Adj\/ are categories, the first step is to associate a
category with each mode $p$.  The rules for $\ap{}{}$ in the previous
section imply that for each $p$, there is a category whose objects are
\wftp{A}{p} and whose morphisms are derivations of \seq{A}{1_p}{B}
quotiented by $\ap{}{}$, with identities given by \ident{} and
composition given by \cut{}{}.  We write $D \cuti E$ as an infix
notation for \cut{D}{E}.  Some standard category-theoretic terminology
applied to categories of this form unpacks as follows:
\begin{enumerate}
\item For $\wftp{A,B}{p}$, an isomorphism $A \iso B$ consists of a pair $D :
\seq{A}{1}{B}$ and $E : \seq{B}{1}{A}$ such that
$\ap{{D} \cuti {E}}{\ident{A}}$ and $\ap{{E} \cuti {D}}{\ident{B}}$.

\item For modes $p$ and $q$, a functor from $p$ to $q$ consists of 
a function $G_0$ from types with mode $p$ to types with mode $q$ 
and a function $G_1$ from derivations \seq{A}{1}{B} to 
derivations \seq{G_0 \, A}{1}{G_0 \, B}, such that
$\ap {G_1(\ident{A})}  {\ident{G_0 A}}$
and
$\ap {G_1(D \cuti E)}  {G_1(D) \cuti G_1(E)}$.

\item For two functors $G,H : p \to q$, a natural transformation $t : G
  \to H$ consists of a family of derivations $D_A :
  \seq{G_0(A)}{1}{H_0(A)}$ for each \wftp{A}{p}, such that for any $D :
  \seq{A}{1_p}{B}$, \ap{\cut{D_A}{(H_1(D))}}{\cut{(G_1(D))}{D_B}}.  A
  natural isomorphism consists of a natural transoformation along with
  inverses demonstrating that each $t_A$ is an isomorphism $G_0(A) \iso
  H_0(A)$.  

\item For two functors $L,R : p \to q$, an adjunction $L \la R$ (using
  the natural bijection of hom sets defintion) consists of functions
  $\ltor{-}{} : (\seq{L_0(A)}{1}{B}) \, \to \, (\seq{A}{1}{R_0(B)})$ and
  $\rtol{-}{} : (\seq{A}{1}{R_0(B)}) \, \to \, (\seq{L_0(A)}{1}{B})$ which are
  mutually inverse and such that \ltor{-}{} is natural in $A$ and $B$: for
  $D_1 : \seq{A'}{1}{A}$ and $D_3 : \seq{B}{1}{B'}$ and $D_2 :
  \seq{L_0(A)}{1}{B}$, \ap{\ltor{(L_1(D_1) \cuti D_2 \cuti D_3)}{}}{D_1
    \cuti \ltor{D_2}{} \cuti {R_1(D_3)}} (it follows that \rtol{-}{} is
  natural as well).  

\item A morphism of adjunctions (or ``adjunction morphism'') from $L^1
  \la_1 R^1$ to $L^2 \la_2 R^2$ consists of two natural transformations
  $t^L : L^1 \to L^2$ and $t^R : R^2 \to R^1$ between the corresponding
  functors that are ``conjugate'' under the adjunction
  structure~\citep{maclane}:
  \[
  \ap {\ltor{\ident{}}{1} \cuti {R^1(t^L_{A})}} { \ltor{\ident{}}{2} \cuti t^R_{L^2(A)} } \text{ for all $A$ }
  \]
  An adjunction isomorphism consists of an adjunction morphism together
  with inverses showing that $t^L$ and $t^R$ are each natural
  isomorphisms.\footnote{This definition is equivalent to ``two inverse
    adjunction morphisms,'' similarly to how isomorphisms that are
    natural are the same as iso-natural transformations---we can recover
    the conjugation condition for one direction from the other.}

\item Because we treat equality of morphisms as
  propositional/proof-irrelevant, two adjunction morphisms $(t^L,t^R)$
  and $({u^L},{u^R}')$ between the same two adjunctions are equal when
  the morphisms $\ap{{t^L}_A}{{u^L}_A}$ and $\ap{{t^L}_A}{{u^L}_A}$
  for all $A$.
\end{enumerate}
%
While these definitions are ``external'' (meta-theoretic), we are
hopeful that it would be possible to internalize them in a dependent
type theory based on adjoint logic.  For example, while the above
definition allows a functor to be given by arbitrary meta-theoretic
functions, in all of the examples we consider, the action on objects is
in fact given by a syntactic type with a ``placeholder'', and the action
on morphisms is given by taking an assumed derivation $D$ and applying
rules to it.  Similarly, all of the equalities are proved by chaining
together the equality rules (including the admissible ones, such as
associativity and identity of cut) from the previous section.

A pseudofunctor is a map between 2-categories that preserves identity
and composition of 1-cells up to coherent isomorphism, rather than on
the nose.\footnote{http://ncatlab.org/nlab/show/pseudofunctor} In this
case, we have a pseudofunctor because e.g. $\F 1 A \iso A \iso \U 1 A$
but this is not an equality of types.

\begin{theorem}[Syntax Determines a Pseudofunctor]
The syntax of adjoint logic determines a pseudeofunctor $\M \to \Adj$:
\begin{enumerate}
\item An object $p$ of \M is sent to the category whose objects are
  \wftp{A}{p} and morphisms are $\seq{A}{1_p}{B}/\ap{}{}$.
\item For each $q,p$, there is a functor from the category of morphisms
  $q \ge p$ to the category of adjoint functors between $q$ and $p$.
  \begin{itemize}
  \item 
  Each $\alpha : q \ge p$ is sent to $F_\alpha \la U_\alpha$ in
  \Adj---$F_\alpha$ and $U_\alpha$ are functors and they are adjoint.

  \item Each 2-cell $e : \tc{\alpha}{\beta}$ is sent to an adjunction
    morphism $(F^2(e),U^2(e)) : (F_\beta \la U_\beta) \to (F_\alpha \la
    U_\alpha)$, and this preserves $1$ and $\compv{e_1}{e_2}$.
  \end{itemize}

\item $\F 1 A \iso A$ and $\U 1 A \iso A$ naturally in $A$, and these
  are conjugate, so there is an adjunction isomorphism $P^1$ between $\F 1 {}
  \la \U 1 {}$ and the identity adjunction.

\item $\F {\compo{\beta}{\alpha}} A \iso \F \alpha {(\F \beta A)}$ and
  $\U {\compo{\beta}{\alpha}} A \iso \U \beta {(\U \alpha A)}$ naturally
  in $A$, and these are conjugate, so there is an adjunction isomorphism
  $P^{\circ}$ between $\F {\compo{\beta}{\alpha}} \la \U
  {\compo{\beta}{\alpha}}$ and the composition of the adjunctions $\F
  {\alpha} \la \U {\alpha}$ and $\F {\beta} \la \U {\beta}$.  Moreover,
  this family of adjunction isomorphism is natural in $\alpha$ and
  $\beta$.

\item Three coherence conditions between $P^1$ and $P^\circ$ are
  satisfied, which relate (1) $P^1$ and $P^\circ(\alpha,1)$,
  (2) $P^1$ and $P^\circ(1,\alpha)$, and (3) 
  $P^\circ(\gamma,\compo{\beta}{\alpha})$ composed with
  $P^\circ(\beta,\alpha)$ and $P^\circ(\gamma,\beta)$ composed with
  $P^\circ(\compo{\gamma}{\beta},\alpha)$.  
\end{enumerate}
\end{theorem}

\begin{proof}
We have given a flavor for some of the maps in the examples above; the
complete construction is in the companion Agda code.  There are many
equations to verify for naturality, conjugation, and coherence, but they
are all true using the \ap{}{} rules.
\end{proof}

\section{Triple Adjunction}
\label{sec:triple}

\subsection{General}

%% It follows that $F$ and $U$ preserve isomorphisms:
%% If $(D,E) : A \cong B$ then $(\F \alpha D,\F \alpha E) : \F \alpha A
%% \cong \F \alpha B$ and $(\U \alpha D,\U \alpha E) : \U \alpha A \cong \U
%% \alpha B$.

\paragraph{$FU$ is a comonad and $UF$ is a monad.}
Write $\Bx{\alpha}{A} := \F{\alpha}{\U{\alpha}{A}}$
and  $\Crc{\alpha}{A} := \U{\alpha}{\F{\alpha}{A}}$.
\Bx{\alpha}{A} is a comonad: 
\begin{enumerate}
\item If $D : \seq{A}{1}{B}$ then $\Bx{\alpha}{D} : \seq{\Bx{\alpha}{A}}{1}{\Bx{\alpha}{B}}$
\item $\dsd{counit} : \seq{\Bx \alpha A}{1}{A}$
\item $\dsd{comult} : \seq{\Bx \alpha A}{1}{\Bx \alpha {\Bx \alpha A}}$
\item 
 \ap{\dsd{comult} \cuti (\Bx{}{\dsd{comult}})}{\dsd{comult} \cuti
   \dsd{comult}}
and \ap{\dsd{comult} \cuti \dsd{counit}}{\ident{}}
and \ap{\dsd{comult} \cuti (\Bx{}{\dsd{counit}})}{\ident{}}.  
\item FIXME: naturality
\end{enumerate}
\Crc{\alpha}{A} is a monad: 
\begin{enumerate}
\item If $D : \seq{A}{1}{B}$ then $\Crc{\alpha}{D} : \seq{\Crc{\alpha}{A}}{1}{\Crc{\alpha}{B}}$
\item $\dsd{unit} : \seq{A}{1}{\Crc \alpha A}$
\item $\dsd{mult} : \seq{\Crc \alpha {\Crc \alpha A}}{1}{\Crc \alpha A}$
 \item 
 \ap{(\Crc{}{\dsd{mult}}) \cuti \dsd{mult} }{\dsd{mult} \cuti
   \dsd{mult}}
and \ap{\dsd{unit} \cuti \dsd{mult}}{\ident{}}
and \ap{(\Crc{}{\dsd{unit}}) \cuti \dsd{mult}}{\ident{}}.  
\item FIXME: naturality
\end{enumerate}

\paragraph{$F$ preserves coproducts.} As an example of left adjoints
preserving colimits and right adjoints preserving limits, we have $\F
\alpha (\coprd A B) \iso \coprd {\F \alpha A} {\F \alpha B}$.  



\subsection{Adjoint Triple}

\subsection{Reflection}

%% The first presentation of cohesive homotopy type
%% theory~\citep{schreibershulman12cohesive} did not extend the judgement
%% structure of type theory, and consequently had trouble with the
%% $\Delta\Gamma$ composite comonad.  

%% Because $\Delta$ and $\nabla$ are full and faithful, it is possible to
%% avoid mention of the category $\mathcal{S}$, and instead focus on the
%% composite endofunctors $\sh := \Delta\sh$, $\flat := \Delta\Gamma$, and
%% $\sharp := \nabla\Gamma$ on \C.  For any adjoint quadruple as above,
%% these will form an adjoint triple $\sh \la \flat \la \sharp$, and $\sh$
%% and $\sharp$ will be monads, while $\flat$ will be a comonad.

%% From a proof-theoretic perspective the $\Gamma$ in a triple adjunction
%% $\Delta \la \Gamma \la \nabla$ is a bit of an odd duck, because it is
%% both a right and a left adjoint, and so should behave like both the $F$
%% and $U$ in adjoint logic.  One possibility would be to design rules for
%% a left-and-right-adjoint connective.  However, such a connective would
%% need to have an unusual focusing~\citep{andreoli92focus} behavior: In
%% any adjunction, left adjoints preserve colimits (e.g. coproducts) and
%% right adjoints preserve limits (e.g. products).  In focusing, limits are
%% negative connectives (invertible on the right, focus on the left), while
%% colimits are positive connectives (invertible on the left, focus on the
%% right), and in general like-polarity connectives compose together well.
%% Reed's adjoint logic is compatible with these two facts, because it
%% admits a focusing interpretation where the left adjoint $F$ is positive
%% and the right adjoint $U$ is negative.  However, if $\Gamma$ is both a
%% left and a right adjoint, it seems like it would need to be both
%% positive and negative.  

%% Instead of giving rules for an ambipolar connective, we will provide a
%% logic in which this comes true up to isomorphism: we can describe a quadruple
%% \[
%% F \la U \cong F' \la U'
%% \]
%% and then define $\Delta := F$, $\nabla := U'$, $\Gamma := U \cong F'$.
%% That is, the functor $\Gamma$ will be defined to be one of two naturally
%% isomorphic functors, one of which is a left adjoint/positive and the
%% other of which is a right adjoint/negative.  This idea is present in
%% Reed's encoding of labeled deduction~\citep[Section ?]{reed09adjoint},
%% where two modes $p,q$ such that $p \ge q$ and $q \ge p$ give rise to
%% adjunctions $F \la U$ and $F' \la U'$ such that $F \cong U'$ and $U
%% \cong F'$.  However, in the case of an adjoint triple, we want $U \cong
%% F'$ but not $F \cong U'$, because $\Delta$ and $\nabla$ are not the
%% same.  

\section{Semantics}
\label{sec:semantics}

\section{Conclusion}

Discuss \sh{} here?


%% \setlength{\bibsep}{-1pt} %% dirty trick: make this negative
{ %% \small
%% \linespread{0.70}
\bibliographystyle{abbrvnat}
\bibliography{drl-common/cs}
}


\end{document}
